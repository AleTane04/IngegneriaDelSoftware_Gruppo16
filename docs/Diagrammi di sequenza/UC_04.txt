@startuml
' Stile conforme alla Slide 13 (Diagrammi di Interazione)
skinparam style strictuml
skinparam sequenceArrowThickness 1.5
skinparam roundcorner 5
skinparam maxmessagesize 150
skinparam sequenceParticipant underline

' Definizione Partecipanti
actor "Bibliotecario" as User
participant ":LibriView" as View
participant ":LibriController" as Controller
participant ":Biblioteca" as Service

' --- FASE 1: VISUALIZZAZIONE INIZIALE (IF-1.5) ---
Note over User, View : All'apertura della sezione Libri

User -> View : Accede alla Dashboard
activate View
    View -> Controller : initialize()
    activate Controller
        
        ' Recupero dell'intera lista
        Controller -> Service : getTuttiLibri()
        activate Service
            Service --> Controller : listaCompleta
        deactivate Service

        Controller -> View : setItems(listaCompleta)
        View --> User : Mostra elenco completo
    deactivate Controller
deactivate View

' --- FASE 2: RICERCA E FILTRAGGIO (IF-1.7, 1.8, 1.9) ---
Note over User, View : Il bibliotecario cerca un libro

User -> View : Digita testo nella barra di ricerca\n(es. "Calvino")
activate View
    
    ' Evento scatenato dalla modifica del testo (Real-time filtering)
    View -> Controller : handleRicerca()
    activate Controller

        ' Recupero della chiave di ricerca
        Controller -> View : getTestoRicerca()
        
        ' Delega la logica di filtro al Service
        Controller -> Service : cercaLibri(testo)
        activate Service
            
            ' Logica interna di filtraggio
            Note right of Service : Filtra per Titolo OR Autore OR ISBN
            
            Service -> Service : listaFiltrata = filtra(listaCompleta, testo)
            
            Service --> Controller : listaFiltrata
        deactivate Service

        ' Aggiornamento della UI
        Controller -> View : aggiornaTabella(listaFiltrata)
        View --> User : Mostra risultati filtrati

    deactivate Controller
deactivate View

@enduml