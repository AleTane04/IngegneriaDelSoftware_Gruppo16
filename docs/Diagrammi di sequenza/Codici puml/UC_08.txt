@startuml
' Stile conforme alla Slide 13 (Diagrammi di Interazione)
skinparam style strictuml
skinparam sequenceArrowThickness 1.5
skinparam roundcorner 5
skinparam maxmessagesize 150
skinparam sequenceParticipant underline

' Definizione Partecipanti
actor "Bibliotecario" as User
participant ":UtentiView" as View
participant ":UtentiController" as Controller
participant ":Biblioteca" as Service

' --- FASE 1: VISUALIZZAZIONE INIZIALE (IF-2.4) ---
Note over User, View : All'apertura della sezione Utenti

User -> View : Accede alla Dashboard
activate View
    View -> Controller : initialize()
    activate Controller
        
        ' Recupero dell'intera lista utenti
        Controller -> Service : getTuttiUtenti()
        activate Service
            Service --> Controller : listaCompleta
        deactivate Service

        Controller -> View : setItems(listaCompleta)
        View --> User : Mostra elenco completo
    deactivate Controller
deactivate View

' --- FASE 2: RICERCA E FILTRAGGIO (IF-2.5, IF-2.6) ---
Note over User, View : Il bibliotecario cerca un utente

User -> View : Digita testo nella barra di ricerca\n(es. matricola o cognome)
activate View
    
    ' Evento scatenato dalla modifica del testo
    View -> Controller : handleRicerca()
    activate Controller

        ' Recupero della chiave di ricerca
        Controller -> View : getTestoRicerca()
        
        ' Delega la logica di filtro al Service
        Controller -> Service : cercaUtenti(testo)
        activate Service
            
            ' Logica interna di filtraggio (Business Logic)
            Note right of Service : Filtra per Cognome OR Matricola
            
            Service -> Service : listaFiltrata = filtra(listaCompleta, testo)
            
            Service --> Controller : listaFiltrata
        deactivate Service

        ' Aggiornamento della UI
        Controller -> View : aggiornaTabella(listaFiltrata)
        View --> User : Mostra risultati filtrati

    deactivate Controller
deactivate View

@enduml